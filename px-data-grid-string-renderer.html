<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../px-tooltip/px-tooltip.html">
<link rel="import" href="px-data-grid-renderer-mixin.html">
<link rel="import" href="px-data-grid-theme.html">

<dom-module id="px-data-grid-string-renderer">
  <template>
    <style include="px-data-grid-styles">
      :host {
        display: flex;
        align-items: center;
        flex-grow: 1;
      }

      #editingTemplate {
        width: 100%;
      }

      input {
        box-sizing: border-box;
      }
    </style>
    <div id="value">[[value]]</div>
    <div id="editingTemplate">
      <input id="editingTemplateInput" class$="{{getClasses(validationResult)}}" type="text" value="{{value::change}}">
      <px-tooltip
        for="editingTemplateInput"
        orientation="top"
        tooltip-message="[[validationResult.message]]"
        opened="[[!validationResult.valid]]"
        ignore-target-events>
    </div>
  </template>
  <script>
    {
      /**
       * A `<px-data-grid-string-renderer>` is standard renderer for string cell content.
       * This element shows how to implement custom renderer in order to display uncommon data.
       * Each renderer that is needed for displaying content should have element with id="value",
       * which is rendered in non-editable state of the cell.
       * You may also provide element with id="editingTemplate", which will display when the cell is editing.
       *
       * @memberof Predix
       * @extends Polymer.Element
       * @mixes Predix.DataGridRendererMixin
       */
      class DataGridStringRenderer extends Predix.DataGridRendererMixin(Polymer.Element) {
        static get is() {
          return 'px-data-grid-string-renderer';
        }

        validate() {
          return {
            valid: !this.column.required || this.value.length > 0,
            message: this.localize('Value is required')
          };
        }

        getClasses(result) {
          return !result || result.valid ? 'text-input' : 'text-input validation-error';
        }
      }

      customElements.define(DataGridStringRenderer.is, DataGridStringRenderer);

      /**
       * @namespace Predix
       */
      window.Predix = window.Predix || {};
      Predix.DataGridStringRenderer = DataGridStringRenderer;
    }
  </script>
</dom-module>
